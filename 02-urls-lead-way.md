# URLs Má»Ÿ ÄÆ°á»ng

Trong bÃ i viáº¿t trÆ°á»›c cá»§a loáº¡t bÃ i [Hiá»ƒu vá» Django](https://www.mattlayman.com/understand-django/), chÃºng ta Ä‘Ã£ tháº¥y cÃ¡ch má»™t yÃªu cáº§u tá»« trÃ¬nh duyá»‡t cá»§a ngÆ°á»i dÃ¹ng Ä‘i tá»« trÃ¬nh duyá»‡t Ä‘áº¿n â€œcá»­a trÆ°á»›câ€ cá»§a Django. BÃ¢y giá» lÃ  lÃºc tÃ¬m hiá»ƒu cÃ¡ch Django xá»­ lÃ½ cÃ¡c yÃªu cáº§u Ä‘Ã³.

Má»™t yÃªu cáº§u HTTP Ä‘áº¿n tá»« trÃ¬nh duyá»‡t sáº½ bao gá»“m má»™t URL mÃ´ táº£ tÃ i nguyÃªn mÃ  Django nÃªn táº¡o ra. VÃ¬ URL cÃ³ thá»ƒ cÃ³ nhiá»u dáº¡ng khÃ¡c nhau, chÃºng ta pháº£i hÆ°á»›ng dáº«n Django vá» cÃ¡c loáº¡i URL mÃ  á»©ng dá»¥ng web cá»§a chÃºng ta cÃ³ thá»ƒ xá»­ lÃ½. ÄÃ¢y chÃ­nh lÃ  nhiá»‡m vá»¥ cá»§a _cáº¥u hÃ¬nh URL_ (URL configuration). Trong tÃ i liá»‡u Django, cáº¥u hÃ¬nh URL Ä‘Æ°á»£c gá»i táº¯t lÃ  URLconf.

URLconf náº±m á»Ÿ Ä‘Ã¢u? URLconf náº±m á»Ÿ Ä‘Æ°á»ng dáº«n module Ä‘Æ°á»£c thiáº¿t láº­p bá»Ÿi thiáº¿t láº­p `ROOT_URLCONF` trong file settings cá»§a dá»± Ã¡n. Náº¿u báº¡n cháº¡y lá»‡nh `startproject`, thÃ¬ thiáº¿t láº­p Ä‘Ã³ sáº½ cÃ³ tÃªn nhÆ° `project.urls` trong Ä‘Ã³ â€œprojectâ€ lÃ  tÃªn báº¡n truyá»n vÃ o lá»‡nh. NÃ³i cÃ¡ch khÃ¡c, URLconf Ä‘Æ°á»£c Ä‘áº·t trong `project/urls.py`, ngay cáº¡nh file `settings.py`.

Äiá»u Ä‘Ã³ giáº£i thÃ­ch vá»‹ trÃ­ cá»§a file, nhÆ°ng chÆ°a nÃ³i nhiá»u vá» cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng. HÃ£y cÃ¹ng tÃ¬m hiá»ƒu sÃ¢u hÆ¡n.

1. [Tá»« TrÃ¬nh Duyá»‡t Äáº¿n Django](https://www.mattlayman.com/understand-django/browser-to-django/)
2. URLs Dáº«n ÄÆ°á»ng
3. [NhÃ¬n VÃ o Views](https://www.mattlayman.com/understand-django/views-on-views/)
4. [Templates Cho Giao Diá»‡n NgÆ°á»i DÃ¹ng](https://www.mattlayman.com/understand-django/templates-user-interfaces/)
5. [TÆ°Æ¡ng TÃ¡c NgÆ°á»i DÃ¹ng Vá»›i Forms](https://www.mattlayman.com/understand-django/user-interaction-forms/)
6. [LÆ°u Trá»¯ Dá»¯ Liá»‡u Vá»›i Models](https://www.mattlayman.com/understand-django/store-data-with-models/)
7. [Quáº£n Trá»‹ Má»i Thá»©](https://www.mattlayman.com/understand-django/administer-all-the-things/)
8. [Giáº£i Pháº«u Má»™t á»¨ng Dá»¥ng](https://www.mattlayman.com/understand-django/anatomy-of-an-application/)
9. [XÃ¡c Thá»±c NgÆ°á»i DÃ¹ng](https://www.mattlayman.com/understand-django/user-authentication/)
10. [Middleware Báº¡n Äi ÄÃ¢u?](https://www.mattlayman.com/understand-django/middleware-do-you-go/)
11. [Phá»¥c Vá»¥ Static Files](https://www.mattlayman.com/understand-django/serving-static-files/)
12. [Kiá»ƒm Thá»­ á»¨ng Dá»¥ng](https://www.mattlayman.com/understand-django/test-your-apps/)
13. [Triá»ƒn Khai Trang Web](https://www.mattlayman.com/understand-django/deploy-site-live/)
14. [Dá»¯ Liá»‡u Theo Tá»«ng NgÆ°á»i DÃ¹ng Vá»›i Sessions](https://www.mattlayman.com/understand-django/sessions/)
15. [Hiá»ƒu Vá» Settings](https://www.mattlayman.com/understand-django/settings/)
16. [Quáº£n LÃ½ File NgÆ°á»i DÃ¹ng](https://www.mattlayman.com/understand-django/media-files/)
17. [Lá»‡nh Cho á»¨ng Dá»¥ng](https://www.mattlayman.com/understand-django/command-apps/)
18. [TÄƒng Tá»‘c Vá»›i Django](https://www.mattlayman.com/understand-django/go-fast/)
19. [Báº£o Máº­t VÃ  Django](https://www.mattlayman.com/understand-django/secure-apps/)
20. [Máº¹o VÃ  Ká»¹ Thuáº­t Gá»¡ Lá»—i](https://www.mattlayman.com/understand-django/debugging-tips-techniques/)

## URLconf Hoáº¡t Äá»™ng NhÆ° Tháº¿ NÃ o

HÃ£y thá»­ nghÄ© vá» cáº¥u hÃ¬nh URL nhÆ° má»™t danh sÃ¡ch cÃ¡c Ä‘Æ°á»ng dáº«n URL mÃ  Django sáº½ cá»‘ gáº¯ng khá»›p tá»« trÃªn xuá»‘ng dÆ°á»›i. Khi Django tÃ¬m tháº¥y má»™t Ä‘Æ°á»ng dáº«n phÃ¹ há»£p, yÃªu cáº§u HTTP sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n má»™t Ä‘oáº¡n mÃ£ Python liÃªn káº¿t vá»›i Ä‘Æ°á»ng dáº«n Ä‘Ã³. Äoáº¡n â€œmÃ£ Pythonâ€ nÃ y Ä‘Æ°á»£c gá»i lÃ  _view_ mÃ  chÃºng ta sáº½ tÃ¬m hiá»ƒu ká»¹ hÆ¡n sau. Hiá»‡n táº¡i, hÃ£y tin ráº±ng view biáº¿t cÃ¡ch xá»­ lÃ½ cÃ¡c yÃªu cáº§u HTTP.

ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng má»™t vÃ­ dá»¥ vá» URLconf Ä‘á»ƒ minh há»a.

```python
# project/urls.py
from django.urls import path

from application import views

urlpatterns = [
    path("", views.home),
    path("about/", views.about),
    path("contact/", views.contact),
    path("terms/", views.terms),
]
```

Nhá»¯ng gÃ¬ cÃ³ á»Ÿ Ä‘Ã¢y ráº¥t phÃ¹ há»£p vá»›i mÃ´ táº£ á»Ÿ trÃªn: má»™t danh sÃ¡ch cÃ¡c Ä‘Æ°á»ng dáº«n URL mÃ  Django sáº½ cá»‘ gáº¯ng khá»›p tá»« trÃªn xuá»‘ng dÆ°á»›i. Äiá»ƒm máº¥u chá»‘t cá»§a danh sÃ¡ch nÃ y lÃ  tÃªn `urlpatterns`. Django sáº½ coi danh sÃ¡ch trong biáº¿n `urlpatterns` lÃ  URLconf.

Thá»© tá»± cá»§a danh sÃ¡ch nÃ y cÅ©ng ráº¥t quan trá»ng vÃ¬ Django sáº½ dá»«ng viá»‡c quÃ©t danh sÃ¡ch ngay khi gáº·p má»™t Ä‘Æ°á»ng dáº«n phÃ¹ há»£p. VÃ­ dá»¥ trÃªn khÃ´ng cÃ³ xung Ä‘á»™t giá»¯a cÃ¡c Ä‘Æ°á»ng dáº«n, nhÆ°ng hoÃ n toÃ n cÃ³ thá»ƒ táº¡o ra hai má»¥c `path` khÃ¡c nhau cÃ³ thá»ƒ khá»›p cÃ¹ng má»™t URL mÃ  ngÆ°á»i dÃ¹ng gá»­i lÃªn. TÃ´i sáº½ minh há»a vÃ­ dá»¥ vá» Ä‘iá»u nÃ y sau khi chÃºng ta xem thÃªm má»™t khÃ­a cáº¡nh khÃ¡c cá»§a path.

ChÃºng ta cÃ³ thá»ƒ lÃ m má»™t vÃ­ dá»¥ Ä‘á»ƒ xem Ä‘iá»u nÃ y hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o vá»›i `www.example.com`. Khi xÃ©t má»™t URL trong URLconf, Django sáº½ bá» qua scheme (`https://`), domain (`www.example.com`) vÃ  dáº¥u gáº¡ch chÃ©o Ä‘áº§u tiÃªn khi so khá»›p. Má»i thá»© cÃ²n láº¡i sáº½ Ä‘Æ°á»£c URLconf dÃ¹ng Ä‘á»ƒ so khá»›p.

- Má»™t yÃªu cáº§u Ä‘áº¿n `https://www.example.com/about/` sáº½ Ä‘Æ°á»£c coi lÃ  `"about/"` trong quÃ¡ trÃ¬nh so khá»›p vÃ  khá»›p vá»›i `path` thá»© hai. YÃªu cáº§u Ä‘Ã³ sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n view `views.about`.
- Má»™t yÃªu cáº§u Ä‘áº¿n `https://www.example.com/` sáº½ Ä‘Æ°á»£c coi lÃ  `""` trong quÃ¡ trÃ¬nh so khá»›p vÃ  khá»›p vá»›i `path` Ä‘áº§u tiÃªn. YÃªu cáº§u Ä‘Ã³ sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n view `views.home`.

> _LÆ°u Ã½: Báº¡n cÃ³ thá»ƒ nháº­n tháº¥y ráº±ng cÃ¡c URL cá»§a Django káº¿t thÃºc báº±ng dáº¥u gáº¡ch chÃ©o. HÃ nh vi nÃ y lÃ  do má»™t lá»±a chá»n trong _[triáº¿t lÃ½ thiáº¿t káº¿](https://docs.djangoproject.com/en/4.1/misc/design-philosophies/#definitive-urls)_ cá»§a Django. Thá»±c táº¿, náº¿u báº¡n cá»‘ gáº¯ng truy cáº­p má»™t URL nhÆ°_ `https://www.example.com/about`_, Django sáº½ chuyá»ƒn hÆ°á»›ng yÃªu cáº§u Ä‘áº¿n cÃ¹ng URL Ä‘Ã³ nhÆ°ng cÃ³ thÃªm dáº¥u gáº¡ch chÃ©o á»Ÿ cuá»‘i nhá» thiáº¿t láº­p_ `APPEND_SLASH`[_máº·c Ä‘á»‹nh_](https://docs.djangoproject.com/en/4.1/ref/settings/#append-slash)_._

## `path` TrÆ°á»›c Máº¯t ChÃºng Ta

Pháº§n chuá»—i trong `path` (vÃ­ dá»¥, `"about/"`) Ä‘Æ°á»£c gá»i lÃ  _route_. Má»™t route cÃ³ thá»ƒ lÃ  má»™t chuá»—i Ä‘Æ¡n giáº£n nhÆ° báº¡n Ä‘Ã£ tháº¥y, nhÆ°ng nÃ³ cÅ©ng cÃ³ thá»ƒ bao gá»“m cÃ¡c cáº¥u trÃºc Ä‘áº·c biá»‡t khÃ¡c vá»›i tÃ­nh nÄƒng gá»i lÃ  _converters_. Khi báº¡n sá»­ dá»¥ng converter, báº¡n cÃ³ thá»ƒ trÃ­ch xuáº¥t thÃ´ng tin tá»« URL Ä‘á»ƒ view sá»­ dá»¥ng sau nÃ y. HÃ£y xem má»™t path nhÆ° sau:

```python
    path(
        "blog/<int:year>/<slug:slug>/",
        views.blog_post
    ),
```

Hai converter trong path nÃ y lÃ :

- `<int:year>`
- `<slug:slug>`

Viá»‡c sá»­ dá»¥ng dáº¥u ngoáº·c nhá»n vÃ  má»™t sá»‘ [tÃªn dÃ nh riÃªng](https://docs.djangoproject.com/en/4.1/topics/http/urls/#path-converters) khiáº¿n Django thá»±c hiá»‡n viá»‡c phÃ¢n tÃ­ch cÃº phÃ¡p bá»• sung trÃªn má»™t URL. Má»—i converter cÃ³ má»™t sá»‘ quy táº¯c mong Ä‘á»£i riÃªng.

- Converter `int` pháº£i khá»›p vá»›i má»™t sá»‘ nguyÃªn.
- Converter `slug` pháº£i khá»›p vá»›i má»™t slug. Slug lÃ  má»™t thuáº­t ngá»¯ bÃ¡o chÃ­ xuáº¥t hiá»‡n trong Django vÃ¬ Django báº¯t nguá»“n tá»« má»™t dá»± Ã¡n cá»§a má»™t tá» bÃ¡o á»Ÿ Kansas. Má»™t slug lÃ  má»™t chuá»—i cÃ³ thá»ƒ bao gá»“m kÃ½ tá»±, sá»‘, dáº¥u gáº¡ch ngang vÃ  dáº¥u gáº¡ch dÆ°á»›i.

Vá»›i cÃ¡c Ä‘á»‹nh nghÄ©a converter Ä‘Ã³, hÃ£y so sÃ¡nh vá»›i má»™t sá»‘ URL!

- `https://www.example.com/blog/2020/urls-lead-way/` - KHá»šP!
- `https://www.example.com/blog/twenty-twenty/urls-lead-way/` - KHÃ”NG KHá»šP.
- `https://www.example.com/blog/0/life-in-rome/` - KHá»šP! á»ªm, cÃ³ thá»ƒ khÃ´ng pháº£i Ä‘iá»u chÃºng ta muá»‘n. HÃ£y xem xÃ©t Ä‘iá»u Ä‘Ã³ sá»›m.

BÃ¢y giá» chÃºng ta cÃ³ thá»ƒ quay láº¡i váº¥n Ä‘á» vá» thá»© tá»± tá»« trÆ°á»›c. HÃ£y xem hai path nÃ y vá»›i thá»© tá»± khÃ¡c nhau:

```python
    path(
        "blog/<int:year>/",
        views.blog_by_year
    ),
    path(
        "blog/2020/",
        views.blog_for_twenty_twenty
    ),

# vs.

    path(
        "blog/2020/",
        views.blog_for_twenty_twenty
    ),
    path(
        "blog/<int:year>/",
        views.blog_by_year
    ),
```

á» thá»© tá»± Ä‘áº§u tiÃªn, converter sáº½ khá»›p vá»›i báº¥t ká»³ sá»‘ nguyÃªn nÃ o sau `blog/`, bao gá»“m cáº£ `https://www.example.com/blog/2020/`. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  thá»© tá»± Ä‘áº§u tiÃªn sáº½ khÃ´ng bao giá» gá»i view `blog_for_twenty_twenty` vÃ¬ Django sáº½ khá»›p cÃ¡c má»¥c `path` theo thá»© tá»±.

NgÆ°á»£c láº¡i, á»Ÿ thá»© tá»± thá»© hai, `blog/2020/` sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n `blog_for_twenty_twenty` Ä‘Ãºng cÃ¡ch vÃ¬ nÃ³ Ä‘Æ°á»£c khá»›p trÆ°á»›c. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  cÃ³ má»™t bÃ i há»c cáº§n nhá»› á»Ÿ Ä‘Ã¢y:

â€Œ

> _Khi thÃªm cÃ¡c má»¥c_ `path` _khá»›p vá»›i má»™t dáº£i giÃ¡ trá»‹ báº±ng converter (nhÆ° vÃ­ dá»¥ nÄƒm á»Ÿ trÃªn), hÃ£y cháº¯c cháº¯n Ä‘áº·t chÃºng **sau** cÃ¡c má»¥c cá»¥ thá»ƒ hÆ¡n._

## Má»™t GÃ³c NhÃ¬n Ngáº¯n Gá»n Vá» Views

CÃ¡c converter lÃ m gÃ¬ vá»›i dá»¯ liá»‡u bá»• sung nÃ y? Tháº­t khÃ³ Ä‘á»ƒ giáº£i thÃ­ch mÃ  khÃ´ng Ä‘á» cáº­p Ä‘áº¿n views. BÃ i tiáº¿p theo sáº½ nÃ³i ká»¹ hÆ¡n vá» views, nhÆ°ng Ä‘Ã¢y lÃ  pháº§n giá»›i thiá»‡u.

Má»™t view lÃ  Ä‘oáº¡n mÃ£ nháº­n má»™t request vÃ  tráº£ vá» má»™t response. Sá»­ dá»¥ng gá»£i Ã½ kiá»ƒu dá»¯ liá»‡u tÃ¹y chá»n cá»§a Python, Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ sáº½ gá»­i response `Hello World`.

```python
from django.http import (
    HttpRequest,
    HttpResponse
)

def some_view(
    request: HttpRequest
) -> HttpResponse:
    return HttpResponse('Hello World')
```

`HttpRequest` lÃ  Ä‘á»‹nh dáº¡ng Ä‘Ã£ Ä‘Æ°á»£c Django chuyá»ƒn Ä‘á»•i cá»§a má»™t yÃªu cáº§u HTTP, Ä‘Æ°á»£c gÃ³i trong má»™t lá»›p tiá»‡n lá»£i. TÆ°Æ¡ng tá»±, `HttpResponse` lÃ  thá»© chÃºng ta cÃ³ thá»ƒ dÃ¹ng Ä‘á»ƒ Django chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u pháº£n há»“i cá»§a chÃºng ta thÃ nh má»™t pháº£n há»“i HTTP Ä‘Ãºng chuáº©n Ä‘á»ƒ gá»­i láº¡i cho trÃ¬nh duyá»‡t ngÆ°á»i dÃ¹ng.

BÃ¢y giá» chÃºng ta cÃ³ thá»ƒ xem láº¡i má»™t trong cÃ¡c converter.

```python
    path(
        "blog/<int:year>/",
        views.blog_by_year
    ),
```

Vá»›i converter nÃ y trong route, `blog_by_year` sáº½ trÃ´ng nhÆ° tháº¿ nÃ o?

```python
# application/views.py
from django.http import HttpResponse

def blog_by_year(request, year):
    # ... some code to handle the year
    data = 'Some data set by code above'
    return HttpResponse(data)
```

Django báº¯t Ä‘áº§u bá»™c lá»™ má»™t sá»‘ Ä‘iá»ƒm hay á»Ÿ Ä‘Ã¢y! Converter Ä‘Ã£ lÃ m ráº¥t nhiá»u viá»‡c táº» nháº¡t cho chÃºng ta. Tham sá»‘ `year` do Django truyá»n vÃ o sáº½ lÃ  má»™t sá»‘ nguyÃªn vÃ¬ Django Ä‘Ã£ thá»±c hiá»‡n viá»‡c phÃ¢n tÃ­ch chuá»—i vÃ  chuyá»ƒn Ä‘á»•i.

Náº¿u ai Ä‘Ã³ gá»­i `/blog/not_a_number/`, Django sáº½ tráº£ vá» pháº£n há»“i Not Found vÃ¬ `not_a_number` khÃ´ng thá»ƒ lÃ  má»™t sá»‘ nguyÃªn. Lá»£i Ã­ch cá»§a Ä‘iá»u nÃ y lÃ  chÃºng ta khÃ´ng pháº£i thÃªm logic kiá»ƒm tra bá»• sung trong `blog_by_year` Ä‘á»ƒ xá»­ lÃ½ trÆ°á»ng há»£p ká»³ láº¡ khi `year` khÃ´ng giá»‘ng má»™t con sá»‘. TÃ­nh nÄƒng nÃ y thá»±c sá»± tiáº¿t kiá»‡m thá»i gian! NÃ³ giÃºp mÃ£ cá»§a báº¡n sáº¡ch hÆ¡n _vÃ _ xá»­ lÃ½ chÃ­nh xÃ¡c hÆ¡n.

CÃ²n vÃ­ dá»¥ ká»³ láº¡ khÃ¡c mÃ  chÃºng ta Ä‘Ã£ tháº¥y trÆ°á»›c Ä‘Ã³ lÃ  `/blog/0/life-in-rome/` thÃ¬ sao? ÄÆ°á»ng dáº«n Ä‘Ã³ sáº½ khá»›p vá»›i pattern á»Ÿ pháº§n trÆ°á»›c, nhÆ°ng giáº£ sá»­ chÃºng ta muá»‘n chá»‰ khá»›p vá»›i nÄƒm cÃ³ bá»‘n chá»¯ sá»‘. LÃ m sao Ä‘á»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³? ChÃºng ta cÃ³ thá»ƒ dÃ¹ng biá»ƒu thá»©c chÃ­nh quy.

## ÄÆ°á»ng Dáº«n Biá»ƒu Thá»©c ChÃ­nh Quy

Biá»ƒu thá»©c chÃ­nh quy lÃ  má»™t tÃ­nh nÄƒng láº­p trÃ¬nh thÆ°á»ng Ä‘Æ°á»£c vÃ­ nhÆ° má»™t chiáº¿c cÆ°a mÃ¡y: _chÃºng cá»±c ká»³ máº¡nh máº½, nhÆ°ng báº¡n cÃ³ thá»ƒ tá»± cáº¯t chÃ¢n mÃ¬nh náº¿u khÃ´ng cáº©n tháº­n._

Biá»ƒu thá»©c chÃ­nh quy cÃ³ thá»ƒ diá»…n Ä‘áº¡t cÃ¡c máº«u kÃ½ tá»± phá»©c táº¡p má»™t cÃ¡ch ngáº¯n gá»n. Sá»± ngáº¯n gá»n nÃ y thÆ°á»ng khiáº¿n biá»ƒu thá»©c chÃ­nh quy bá»‹ mang tiáº¿ng lÃ  khÃ³ hiá»ƒu. Tuy nhiÃªn, khi sá»­ dá»¥ng cáº©n tháº­n, chÃºng ráº¥t hiá»‡u quáº£.

Má»™t biá»ƒu thá»©c chÃ­nh quy (thÆ°á»ng Ä‘Æ°á»£c viáº¿t táº¯t lÃ  â€œregexâ€) sáº½ khá»›p cÃ¡c máº«u phá»©c táº¡p trong chuá»—i. Äiá»u nÃ y nghe cÃ³ váº» giá»‘ng há»‡t váº¥n Ä‘á» vá» nÄƒm cá»§a blog! Trong váº¥n Ä‘á» cá»§a chÃºng ta, chÃºng ta muá»‘n chá»‰ khá»›p vá»›i sá»‘ nguyÃªn cÃ³ bá»‘n chá»¯ sá»‘. HÃ£y xem má»™t giáº£i phÃ¡p mÃ  Django cÃ³ thá»ƒ xá»­ lÃ½ rá»“i phÃ¢n tÃ­ch Ã½ nghÄ©a cá»§a nÃ³.

Nháº¯c láº¡i, giáº£i phÃ¡p nÃ y sáº½ khá»›p vá»›i má»™t Ä‘Æ°á»ng dáº«n URL nhÆ° `blog/2020/urls-lead-way/`.

LÆ°u Ã½, chÃºng ta dÃ¹ng hÃ m `re_path()` Ä‘á»ƒ khá»›p biá»ƒu thá»©c chÃ­nh quy thay vÃ¬ `path()`.

```python
re_path(
    r"^blog/(?P<year>[0-9]{4})/(?P<slug>[\w-]+)/$",
    views.blog_post
),
```

Chuá»—i â€œká»³ láº¡â€ nÃ y hoáº¡t Ä‘á»™ng giá»‘ng há»‡t vÃ­ dá»¥ trÆ°á»›c **ngoáº¡i trá»«** viá»‡c nÃ³ chÃ­nh xÃ¡c hÆ¡n vá» viá»‡c chá»‰ cho phÃ©p nÄƒm cÃ³ bá»‘n chá»¯ sá»‘. Chuá»—i â€œká»³ láº¡â€ nÃ y cÅ©ng cÃ³ má»™t cÃ¡i tÃªn. NÃ³ Ä‘Æ°á»£c gá»i lÃ  _máº«u regex_ (regex pattern). Khi mÃ£ Django cháº¡y, nÃ³ sáº½ kiá»ƒm tra cÃ¡c Ä‘Æ°á»ng dáº«n URL dá»±a trÃªn cÃ¡c quy táº¯c Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong máº«u nÃ y.

Äá»ƒ hiá»ƒu cÃ¡ch nÃ³ hoáº¡t Ä‘á»™ng, chÃºng ta cáº§n biáº¿t Ã½ nghÄ©a cá»§a tá»«ng pháº§n trong máº«u. HÃ£y giáº£i thÃ­ch máº«u nÃ y tá»«ng Ä‘oáº¡n má»™t.

- Chuá»—i báº¯t Ä‘áº§u báº±ng `r"` vÃ¬ nÃ³ lÃ  chuá»—i raw trong Python. Äiá»u nÃ y Ä‘Æ°á»£c dÃ¹ng vÃ¬ biá»ƒu thá»©c chÃ­nh quy sá»­ dá»¥ng `\` ráº¥t nhiá»u. Náº¿u khÃ´ng dÃ¹ng chuá»—i raw, láº­p trÃ¬nh viÃªn sáº½ pháº£i escape dáº¥u gáº¡ch chÃ©o ngÆ°á»£c liÃªn tá»¥c báº±ng cÃ¡ch dÃ¹ng `\\`.
- Dáº¥u mÅ© `^` nghÄ©a lÃ  â€œmáº«u pháº£i _báº¯t Ä‘áº§u_ tá»« Ä‘Ã¢y.â€ Nhá» dáº¥u mÅ©, má»™t path báº¯t Ä‘áº§u nhÆ° `myblog/...` sáº½ khÃ´ng khá»›p.
- `blog/` lÃ  pháº§n khá»›p Ä‘Ãºng tá»«ng kÃ½ tá»±. CÃ¡c kÃ½ tá»± nÃ y pháº£i khá»›p chÃ­nh xÃ¡c.
- Pháº§n trong ngoáº·c Ä‘Æ¡n `(?P<year>[0-9]{4})` lÃ  má»™t _capture group_. `?P<year>` lÃ  tÃªn gÃ¡n cho capture group vÃ  tÆ°Æ¡ng tá»± nhÆ° pháº§n bÃªn pháº£i dáº¥u hai cháº¥m trong converter nhÆ° `<int:year>`. TÃªn nÃ y cho phÃ©p Django truyá»n ná»™i dung vÃ o má»™t tham sá»‘ tÃªn lÃ  `year` cho view. Pháº§n cÃ²n láº¡i cá»§a capture group, `[0-9]{4}`, lÃ  pháº§n máº«u thá»±c sá»± sáº½ khá»›p. `[0-9]` lÃ  _character class_ nghÄ©a lÃ  â€œkhá»›p vá»›i báº¥t ká»³ sá»‘ nÃ o tá»« 0 Ä‘áº¿n 9.â€ `{4}` nghÄ©a lÃ  pháº£i khá»›p **chÃ­nh xÃ¡c** bá»‘n láº§n. ÄÃ¢y lÃ  sá»± chÃ­nh xÃ¡c mÃ  `re_path` mang láº¡i mÃ  converter `int` khÃ´ng thá»ƒ!
- Dáº¥u gáº¡ch chÃ©o `/` giá»¯a cÃ¡c capture group lÃ  kÃ½ tá»± khá»›p Ä‘Ãºng tá»«ng kÃ½ tá»±.
- Capture group thá»© hai, `(?P<slug>[\w-]+)`, sáº½ Ä‘Æ°a báº¥t ká»³ giÃ¡ trá»‹ nÃ o nÃ³ khá»›p vÃ o tham sá»‘ tÃªn lÃ  `slug`. Character class `[\w-]` chá»©a hai loáº¡i kÃ½ tá»±. `\w` nghÄ©a lÃ  báº¥t ká»³ kÃ½ tá»± tá»« nÃ o báº¡n cÃ³ thá»ƒ cÃ³ trong ngÃ´n ngá»¯ tá»± nhiÃªn, sá»‘ vÃ  dáº¥u gáº¡ch dÆ°á»›i. Loáº¡i kÃ½ tá»± cÃ²n láº¡i lÃ  dáº¥u gáº¡ch ngang `-`. Cuá»‘i cÃ¹ng, dáº¥u cá»™ng `+` nghÄ©a lÃ  character class pháº£i khá»›p Ã­t nháº¥t 1 láº§n trá»Ÿ lÃªn.
- Dáº¥u gáº¡ch chÃ©o cuá»‘i cÃ¹ng cÅ©ng lÃ  kÃ½ tá»± khá»›p Ä‘Ãºng tá»«ng kÃ½ tá»±.
- Äá»ƒ káº¿t thÃºc máº«u, dáº¥u Ä‘Ã´ la `$` Ä‘Ã³ng vai trÃ² ngÆ°á»£c láº¡i vá»›i dáº¥u mÅ© vÃ  nghÄ©a lÃ  â€œmáº«u pháº£i _káº¿t thÃºc_ á»Ÿ Ä‘Ã¢y.â€ Do Ä‘Ã³, `blog/2020/some-slug/another-slug/` sáº½ khÃ´ng khá»›p.

LÆ°u Ã½ ráº±ng báº¡n khÃ´ng thá»ƒ trá»™n láº«n kiá»ƒu `path` vÃ  kiá»ƒu chuá»—i `re_path`. VÃ­ dá»¥ trÃªn pháº£i mÃ´ táº£ slug báº±ng biá»ƒu thá»©c chÃ­nh quy thay vÃ¬ dÃ¹ng converter slug (tá»©c lÃ  `<slug:slug>`).

ChÃºc má»«ng báº¡n! ÄÃ¢y cháº¯c cháº¯n lÃ  pháº§n khÃ³ nháº¥t cá»§a bÃ i viáº¿t nÃ y. Náº¿u báº¡n hiá»ƒu nhá»¯ng gÃ¬ chÃºng ta Ä‘Ã£ lÃ m vá»›i `re_path`, pháº§n cÃ²n láº¡i sáº½ ráº¥t dá»… dÃ ng. Náº¿u chÆ°a, _Ä‘á»«ng lo láº¯ng!_ Náº¿u báº¡n muá»‘n biáº¿t thÃªm vá» biá»ƒu thá»©c chÃ­nh quy, hÃ£y nhá»› ráº±ng má»i thá»© tÃ´i mÃ´ táº£ trong máº«u nÃ y _khÃ´ng_ pháº£i lÃ  Ä‘áº·c trÆ°ng cá»§a Django. Thay vÃ o Ä‘Ã³, Ä‘Ã¢y lÃ  hÃ nh vi tÃ­ch há»£p sáºµn cá»§a Python. Báº¡n cÃ³ thá»ƒ tÃ¬m hiá»ƒu thÃªm vá» biá»ƒu thá»©c chÃ­nh quy tá»« [Regular Expression HOWTO cá»§a Python](https://docs.python.org/3/howto/regex.html).

Biáº¿t ráº±ng sá»©c máº¡nh cá»§a `re_path` luÃ´n á»Ÿ Ä‘Ã³ cÃ³ thá»ƒ giÃºp báº¡n sau nÃ y trÃªn hÃ nh trÃ¬nh Django, ngay cáº£ khi báº¡n chÆ°a cáº§n Ä‘áº¿n nÃ³ bÃ¢y giá».

## NhÃ³m CÃ¡c URL LiÃªn Quan

Äáº¿n thá»i Ä‘iá»ƒm nÃ y, chÃºng ta Ä‘Ã£ xem cÃ¡c route riÃªng láº» mÃ  báº¡n cÃ³ thá»ƒ Ã¡nh xáº¡ trong URLconf. Váº­y chÃºng ta cÃ³ thá»ƒ lÃ m gÃ¬ khi má»™t nhÃ³m view liÃªn quan nÃªn chia sáº» má»™t Ä‘Æ°á»ng dáº«n chung? Táº¡i sao láº¡i muá»‘n lÃ m nhÆ° váº­y?

HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n Ä‘ang xÃ¢y dá»±ng má»™t dá»± Ã¡n giÃ¡o dá»¥c. Trong dá»± Ã¡n, báº¡n cÃ³ trÆ°á»ng há»c, há»c sinh vÃ  cÃ¡c khÃ¡i niá»‡m liÃªn quan Ä‘áº¿n giÃ¡o dá»¥c khÃ¡c. Báº¡n _cÃ³ thá»ƒ_ lÃ m nhÆ° sau:

```python
# project/urls.py
from django.urls import path

from schools import (
    views as schools_views,
)
from students import (
    views as students_views,
)

urlpatterns = [
    path(
        "schools/", schools_views.index
    ),
    path(
        "schools/<int:school_id>/",
        schools_views.school_detail,
    ),
    path(
        "students/",
        students_views.index,
    ),
    path(
        "students/<int:student_id>/",
        students_views.student_detail,
    ),
]
```

CÃ¡ch tiáº¿p cáº­n nÃ y váº«n hoáº¡t Ä‘á»™ng tá»‘t, nhÆ°ng nÃ³ buá»™c URLconf gá»‘c pháº£i biáº¿t vá» táº¥t cáº£ cÃ¡c view Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong tá»«ng app, `schools` vÃ  `students`. Thay vÃ o Ä‘Ã³, chÃºng ta cÃ³ thá»ƒ dÃ¹ng `include` Ä‘á»ƒ xá»­ lÃ½ tá»‘t hÆ¡n.

```python
# project/urls.py
from django.urls import include, path

urlpatterns = [
    path(
        "schools/",
        include("schools.urls"),
    ),
    path(
        "students/",
        include("students.urls"),
    ),
]
```

Sau Ä‘Ã³, trong má»—i á»©ng dá»¥ng, chÃºng ta sáº½ cÃ³ nhÆ° sau:

```python
# schools/urls.py
from django.urls import path

from schools import views

urlpatterns = [
    path("", views.index),
    path(
        "<int:school_id>/",
        views.school_detail
    ),
]
```

Viá»‡c sá»­ dá»¥ng `include` giÃºp má»—i app Django tá»± chá»§ trong viá»‡c xÃ¡c Ä‘á»‹nh cÃ¡c view cáº§n thiáº¿t. Dá»± Ã¡n cÃ³ thá»ƒ â€œkhÃ´ng biáº¿tâ€ vá» nhá»¯ng gÃ¬ á»©ng dá»¥ng Ä‘ang lÃ m.

NgoÃ i ra, viá»‡c láº·p láº¡i `schools/` hoáº·c `students/` Ä‘Æ°á»£c loáº¡i bá» so vá»›i vÃ­ dá»¥ Ä‘áº§u tiÃªn. Khi Django xá»­ lÃ½ má»™t route, nÃ³ sáº½ khá»›p pháº§n Ä‘áº§u cá»§a route vÃ  chuyá»ƒn _pháº§n cÃ²n láº¡i_ cho URLconf Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a trong tá»«ng app. Theo cÃ¡ch nÃ y, cáº¥u hÃ¬nh URL cÃ³ thá»ƒ táº¡o thÃ nh má»™t cÃ¢y, trong Ä‘Ã³ URLconf gá»‘c lÃ  nÆ¡i má»i yÃªu cáº§u báº¯t Ä‘áº§u, nhÆ°ng tá»«ng á»©ng dá»¥ng sáº½ xá»­ lÃ½ chi tiáº¿t khi má»™t yÃªu cáº§u Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n app phÃ¹ há»£p.

## Äáº·t TÃªn Cho URL

ChÃºng ta Ä‘Ã£ xem cÃ¡c cÃ¡ch chÃ­nh Ä‘á»ƒ Ä‘á»‹nh nghÄ©a URL vá»›i `path`, `re_path` vÃ  `include`. CÃ³ má»™t khÃ­a cáº¡nh khÃ¡c cáº§n xem xÃ©t. LÃ m tháº¿ nÃ o Ä‘á»ƒ tham chiáº¿u Ä‘áº¿n cÃ¡c URL á»Ÿ nhá»¯ng nÆ¡i khÃ¡c trong mÃ£? HÃ£y xem view (hÆ¡i ngá»› ngáº©n) nÃ y:

```python
# application/views.py
from django.http import (
    HttpResponseRedirect
)

def old_blog_categories(request):
    return HttpResponseRedirect(
        "/blog/categories/"
    )
```

Redirect lÃ  khi ngÆ°á»i dÃ¹ng cá»‘ gáº¯ng truy cáº­p má»™t trang vÃ  Ä‘Æ°á»£c trÃ¬nh duyá»‡t chuyá»ƒn Ä‘áº¿n nÆ¡i khÃ¡c. CÃ³ nhiá»u cÃ¡ch tá»‘t hÆ¡n Ä‘á»ƒ xá»­ lÃ½ redirect so vá»›i vÃ­ dá»¥ nÃ y, nhÆ°ng view nÃ y minh há»a má»™t Ä‘iá»ƒm khÃ¡c. Äiá»u gÃ¬ sáº½ xáº£y ra náº¿u báº¡n muá»‘n cáº¥u trÃºc láº¡i dá»± Ã¡n Ä‘á»ƒ cÃ¡c danh má»¥c blog chuyá»ƒn tá»« `/blog/categories/` sang `/marketing/blog/categories/`? á» dáº¡ng hiá»‡n táº¡i, chÃºng ta sáº½ pháº£i sá»­a view nÃ y vÃ  báº¥t ká»³ view nÃ o khÃ¡c tham chiáº¿u trá»±c tiáº¿p Ä‘áº¿n route Ä‘Ã³.

Tháº­t lÃ£ng phÃ­ thá»i gian! Django cung cáº¥p cho chÃºng ta cÃ´ng cá»¥ Ä‘á»ƒ Ä‘áº·t tÃªn cho cÃ¡c path Ä‘á»™c láº­p vá»›i route cá»¥ thá»ƒ. ChÃºng ta lÃ m Ä‘iá»u nÃ y vá»›i tham sá»‘ `name` cá»§a `path`.

```python
# project/urls.py
from django.urls import path

from blog import views

urlpatterns = [
    ...
    path(
        "/marketing/blog/categories/",
        views.categories,
        name="blog_categories"
    ),
    ...
]
```

Äiá»u nÃ y giÃºp chÃºng ta cÃ³ `blog_categories` lÃ  má»™t tÃªn Ä‘á»™c láº­p vá»›i route `/marketing/blog/categories/`. Äá»ƒ sá»­ dá»¥ng tÃªn Ä‘Ã³, chÃºng ta cáº§n `reverse` nhÆ° má»™t Ä‘á»‘i tÃ¡c. View Ä‘Ã£ chá»‰nh sá»­a cá»§a chÃºng ta nhÆ° sau:

```python
# application/views.py
from django.http import (
    HttpResponseRedirect
)
from django.urls import reverse

def old_blog_categories(request):
    return HttpResponseRedirect(
        reverse("blog_categories")
    )
```

Nhiá»‡m vá»¥ cá»§a `reverse` lÃ  tra cá»©u báº¥t ká»³ tÃªn path nÃ o vÃ  tráº£ vá» route tÆ°Æ¡ng á»©ng. Äiá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ :

```python
reverse("blog_categories") == "/marketing/blog/categories/"
```

Ãt nháº¥t lÃ  cho Ä‘áº¿n khi báº¡n muá»‘n thay Ä‘á»•i nÃ³ láº§n ná»¯a. ğŸ˜

## Khi TÃªn Bá»‹ TrÃ¹ng

Äiá»u gÃ¬ xáº£y ra náº¿u báº¡n cÃ³ nhiá»u URL muá»‘n Ä‘áº·t cÃ¹ng má»™t `name`? VÃ­ dá»¥, `index` hoáº·c `detail` lÃ  nhá»¯ng tÃªn phá»• biáº¿n mÃ  báº¡n cÃ³ thá»ƒ muá»‘n dÃ¹ng. ChÃºng ta cÃ³ thá»ƒ tham kháº£o [The Zen of Python](https://www.python.org/dev/peps/pep-0020/) Ä‘á»ƒ xin lá»i khuyÃªn.

> _The Zen of Python, by Tim Peters_
>
> _Äáº¹p hÆ¡n lÃ  xáº¥u._
>
> _â€¦_
>
> _**Namespaces lÃ  má»™t Ã½ tÆ°á»Ÿng tuyá»‡t vá»i â€“ hÃ£y dÃ¹ng nhiá»u hÆ¡n ná»¯a!**_

Namespace cÃ³ thá»ƒ lÃ  khÃ¡i niá»‡m má»›i náº¿u báº¡n chÆ°a láº­p trÃ¬nh lÃ¢u. ChÃºng lÃ  _khÃ´ng gian chung cho cÃ¡c tÃªn_. CÃ³ thá»ƒ Ä‘iá»u nÃ y Ä‘Ã£ rÃµ, nhÆ°ng tÃ´i nhá»› mÃ¬nh tá»«ng gáº·p khÃ³ khÄƒn vá»›i khÃ¡i niá»‡m nÃ y khi má»›i báº¯t Ä‘áº§u láº­p trÃ¬nh.

Äá»ƒ lÃ m phÃ©p so sÃ¡nh vá»›i thá»±c táº¿, hÃ£y dÃ¹ng hÃ¬nh áº£nh nhá»¯ng chiáº¿c xÃ´. HÃ£y tÆ°á»Ÿng tÆ°á»£ng báº¡n cÃ³ hai quáº£ bÃ³ng Ä‘á» vÃ  hai quáº£ bÃ³ng xanh. Äáº·t má»—i quáº£ bÃ³ng má»—i mÃ u vÃ o hai chiáº¿c xÃ´ Ä‘Æ°á»£c dÃ¡n nhÃ£n â€œAâ€ vÃ  â€œB.â€ Náº¿u tÃ´i muá»‘n má»™t quáº£ bÃ³ng xanh cá»¥ thá»ƒ, tÃ´i khÃ´ng thá»ƒ nÃ³i â€œhÃ£y Ä‘Æ°a tÃ´i quáº£ bÃ³ng xanhâ€ vÃ¬ Ä‘iá»u Ä‘Ã³ mÆ¡ há»“. Thay vÃ o Ä‘Ã³, Ä‘á»ƒ láº¥y quáº£ bÃ³ng cá»¥ thá»ƒ, tÃ´i cáº§n nÃ³i â€œhÃ£y Ä‘Æ°a tÃ´i quáº£ bÃ³ng xanh trong xÃ´ B.â€ Trong trÆ°á»ng há»£p nÃ y, chiáº¿c xÃ´ lÃ  namespace.

VÃ­ dá»¥ chÃºng ta dÃ¹ng cho schools vÃ  students cÃ³ thá»ƒ minh há»a Ã½ tÆ°á»Ÿng nÃ y trong mÃ£. Cáº£ hai app Ä‘á»u cÃ³ má»™t view `index` Ä‘á»ƒ Ä‘áº¡i diá»‡n cho gá»‘c cá»§a tá»«ng pháº§n trong dá»± Ã¡n (tá»©c lÃ  `schools/` vÃ  `students/`). Náº¿u chÃºng ta muá»‘n tham chiáº¿u Ä‘áº¿n cÃ¡c view Ä‘Ã³, chÃºng ta sáº½ cá»‘ chá»n tÃªn dá»… nháº¥t lÃ  `index`. Tháº­t khÃ´ng may, náº¿u báº¡n chá»n `index`, Django sáº½ khÃ´ng biáº¿t view nÃ o lÃ  Ä‘Ãºng cho `index`. TÃªn bá»‹ mÆ¡ há»“.

Má»™t giáº£i phÃ¡p lÃ  tá»± táº¡o namespace báº±ng cÃ¡ch thÃªm tiá»n tá»‘ cho `name` nhÆ° `schools_`. Váº¥n Ä‘á» cá»§a cÃ¡ch nÃ y lÃ  URLconf bá»‹ láº·p láº¡i.

```python
# schools/urls.py
from django.urls import path

from schools import views

urlpatterns = [
    path(
        "",
        views.index,
        name="schools_index"
    ),
    path(
        "<int:school_id>/",
        views.school_detail,
        name="schools_detail"
    ),
]
```

Django cung cáº¥p má»™t cÃ¡ch khÃ¡c giÃºp báº¡n giá»¯ tÃªn ngáº¯n hÆ¡n.

```python
# schools/urls.py
from django.urls import path

from schools import views

app_name = "schools"
urlpatterns = [
    path("", views.index, name="index"),
    path(
        "<int:school_id>/",
        views.school_detail,
        name="detail"
    ),
]
```

Báº±ng cÃ¡ch thÃªm `app_name`, chÃºng ta bÃ¡o cho Django biáº¿t cÃ¡c view nÃ y náº±m trong má»™t namespace. BÃ¢y giá» khi muá»‘n láº¥y má»™t URL, chÃºng ta dÃ¹ng tÃªn namespace vÃ  tÃªn URL, ná»‘i vá»›i nhau báº±ng dáº¥u hai cháº¥m.

```
reverse("schools:index") == "/schools/"
```

ÄÃ¢y lÃ  má»™t tiá»‡n Ã­ch khÃ¡c mÃ  Django mang láº¡i Ä‘á»ƒ giÃºp tráº£i nghiá»‡m phÃ¡t triá»ƒn á»©ng dá»¥ng cá»§a báº¡n dá»… dÃ ng hÆ¡n.

NhÆ° váº­y lÃ  chÃºng ta Ä‘Ã£ káº¿t thÃºc chá»§ Ä‘á» vá» URL. Äáº¿n giá», chÃºng ta Ä‘Ã£ biáº¿t cÃ¡ch:

- Táº¡o cáº¥u hÃ¬nh URL báº±ng cÃ¡ch táº¡o má»™t module vá»›i danh sÃ¡ch `urlpatterns`.
- Táº¡o URL vá»›i `path` vÃ  `re_path`.
- Sá»­ dá»¥ng converter Ä‘á»ƒ trÃ­ch xuáº¥t thÃ´ng tin cho view.
- Sá»­ dá»¥ng biá»ƒu thá»©c chÃ­nh quy Ä‘á»ƒ diá»…n Ä‘áº¡t dá»¯ liá»‡u URL phá»©c táº¡p hÆ¡n.
- NhÃ³m cÃ¡c URL liÃªn quan vá»›i `include`.
- Tham chiáº¿u Ä‘áº¿n má»™t URL báº±ng `name`.
- Gom cÃ¡c tÃªn liÃªn quan vÃ o má»™t namespace.

Trong bÃ i tiáº¿p theo, chÃºng ta sáº½ tÃ¬m hiá»ƒu vá» views. BÃ i viáº¿t nÃ y chá»‰ má»›i Ä‘Æ°a ra Ä‘á»‹nh nghÄ©a ngáº¯n gá»n vá» view lÃ  gÃ¬. Django cung cáº¥p cho chÃºng ta ráº¥t nhiá»u lá»±a chá»n phong phÃº khi lÃ m viá»‡c vá»›i views. ChÃºng ta sáº½ khÃ¡m phÃ¡:

- HÃ m view
- Lá»›p view
- Má»™t sá»‘ view há»— trá»£ tÃ­ch há»£p sáºµn
- Decorator giÃºp tÄƒng sá»©c máº¡nh cho view.
